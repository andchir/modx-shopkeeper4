[[!FormIt?
&hooks=`spam,shoppingCart,FormItSaveForm,email,FormItAutoResponder,redirect`
&submitVar=`action_order`
&emailTpl=`shoppingCart_orderReport`
&fiarTpl=`shoppingCart_orderReport`
&emailSubject=`В интернет-магазине "[[++site_name]]" сделан новый заказ`
&fiarSubject=`Вы сделали заказ в интернет-магазине "[[++site_name]]"`
&emailFrom=`[[++emailsender]]`
&emailTo=`[[++emailsender]]`
&fiarReplyTo=`[[++emailsender]]`
&fiarToField=`email`
&redirectTo=`8`
&validate=`address:required,fullname:required,email:email:required,phone:required,delivery:required,payment:required`
&formFields=`fullname,address,phone,email,delivery,payment,message,orderOutputData`
&fieldNames=`fullname==Ф.И.О,address==Адрес,phone==Телефон,email==Адрес эл. почты,delivery==Способ доставки,payment==Способ оплаты,message==Комментарий,orderOutputData==Состав заказа`
&formName=`shop`
&shoppingCartMailRowTpl=`shoppingCart_mailOrderRowTpl`
&shoppingCartMailOuterTpl=`shoppingCart_mailOrderOuterTpl`
]]

<div class="row">
    <div class="col-md-8 offset-md-2">

        <p class="text-danger">[[!+fi.error.error_message]]</p>
        <br />

        <form method="post" action="[[~[[*id]]]]" id="shopOrderForm">

            <fieldset>

                <input type="text" name="nospam:blank" value="" style="display:none;" />
                <input type="hidden" name="action_order" value="1" />

                <div class="form-group">
                    <label for="orderFormName">[[%shopping_cart.full_name?namespace=`shopping_cart`]]:</label>
                    <input name="fullname" id="orderFormName" class="form-control" type="text" value="[[!+fi.fullname:default=`[[+modx.user.id:userinfo=`fullname`]]`:ne=`0`:show]]" />
                    <p class="text-danger small">
                        [[!+fi.error.fullname]]
                    </p>
                </div>

                <div class="form-group">
                    <label for="orderFormAddress">[[%shopping_cart.address?namespace=`shopping_cart`]]:</label>
                    <input name="address" id="orderFormAddress" class="form-control" type="text" value="[[!+fi.address:default=`[[+modx.user.id:userinfo=`address`]]`:ne=`0`:show]]" />
                    <p class="text-danger small">
                        [[!+fi.error.address]]
                    </p>
                </div>

                <div class="row form-group">
                    <div class="col-md-6">

                        <label for="orderFormEmail">[[%shopping_cart.email?namespace=`shopping_cart`]]:</label>
                        <input name="email" id="orderFormEmail" class="form-control" type="text" value="[[!+fi.email:default=`[[+modx.user.id:userinfo=`email`]]`:ne=`0`:show]]" />
                        <p class="text-danger small">
                            [[!+fi.error.email]]
                        </p>

                    </div>
                    <div class="col-md-6">

                        <label for="orderFormPhone">[[%shopping_cart.phone?namespace=`shopping_cart`]]:</label>
                        <input name="phone" id="orderFormPhone" class="form-control" type="text" value="[[!+fi.phone:default=`[[+modx.user.id:userinfo=`phone`]]`:ne=`0`:show]]" />
                        <p class="text-danger small">
                            [[!+fi.error.phone]]
                        </p>

                    </div>
                </div>

                <div class="row form-group">
                    <div class="col-md-6">

                        <label for="orderFormDelivery">[[%shopping_cart.delivery_method?namespace=`shopping_cart`]]:</label>
                        <select name="delivery" id="orderFormDelivery" class="form-control">
                            <option value=""></option>
                            <option value="[[%shopping_cart.self_export?namespace=`shopping_cart`]]" [[!+fi.delivery:FormItIsSelected=`Самовывоз`]]>[[%shopping_cart.self_export?namespace=`shopping_cart`]]</option>
                            <option value="[[%shopping_cart.postal_service?namespace=`shopping_cart`]]" [[!+fi.delivery:FormItIsSelected=`Почта России`]]>[[%shopping_cart.postal_service?namespace=`shopping_cart`]]</option>
                            <option value="[[%shopping_cart.transport_company?namespace=`shopping_cart`]]" [[!+fi.delivery:FormItIsSelected=`Транспортная компания`]]>[[%shopping_cart.transport_company?namespace=`shopping_cart`]]</option>
                        </select>
                        <p class="text-danger small">
                            [[!+fi.error.delivery]]
                        </p>

                    </div>
                    <div class="col-md-6">

                        <label for="orderFormPayment">[[%shopping_cart.payment_method?namespace=`shopping_cart`]]:</label>
                        <select name="payment" id="orderFormPayment" class="form-control">
                            <option value=""></option>
                            <option value="[[%shopping_cart.bank_card?namespace=`shopping_cart`]]" [[!+fi.payment:FormItIsSelected=`Банковская карта`]]>[[%shopping_cart.bank_card?namespace=`shopping_cart`]]</option>
                            <option value="[[%shopping_cart.electronic_money?namespace=`shopping_cart`]]" [[!+fi.payment:FormItIsSelected=`Электронные деньги`]]>[[%shopping_cart.electronic_money?namespace=`shopping_cart`]]</option>
                            <option value="[[%shopping_cart.payment_upon_receipt?namespace=`shopping_cart`]]" [[!+fi.payment:FormItIsSelected=`При получении`]]>[[%shopping_cart.payment_upon_receipt?namespace=`shopping_cart`]]</option>
                        </select>
                        <p class="text-danger small">
                            [[!+fi.error.payment]]
                        </p>

                    </div>
                </div>

                <div class="form-group">
                    <label for="orderFormComment">
                        [[%shopping_cart.comment?namespace=`shopping_cart`]]:
                    </label>
                    <textarea name="message" id="orderFormComment" class="form-control" rows="4" cols="30">[[!+fi.message]]</textarea>
                </div>

                <div class="form-group">
                    <button type="submit" name="submit_button" class="button btn btn-primary btn-lg">
                        [[%shopping_cart.submit?namespace=`shopping_cart`]]
                    </button>
                </div>

            </fieldset>

        </form>

    </div>
</div>
